# Reference

<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

### Classes

#### Public Classes

* [`prosa`](#prosa): Guides the basic setup and installation of ProSA on your system.
* [`prosa::processors`](#prosa--processors): Creates `prosa::proc` defined types.

#### Private Classes

* `prosa::params`: This class manages ProSA parameters
* `prosa::service`: Installs and configures ProSA service.

### Defined types

* [`prosa::proc`](#prosa--proc): Allows specialised configurations for ProSA processors

### Data types

* [`ProSA::TelemetryLevel`](#ProSA--TelemetryLevel): A string that conforms to the ProSA `TelemetryLevel` syntax.

## Classes

### <a name="prosa"></a>`prosa`

A description of what this class does

#### Examples

##### 

```puppet
class { 'prosa': }
```

#### Parameters

The following parameters are available in the `prosa` class:

* [`prosa_name`](#-prosa--prosa_name)
* [`service_name`](#-prosa--service_name)
* [`bin_repo`](#-prosa--bin_repo)
* [`bin_path`](#-prosa--bin_path)
* [`log_dir`](#-prosa--log_dir)
* [`conf_dir`](#-prosa--conf_dir)
* [`service_enable`](#-prosa--service_enable)
* [`service_manage`](#-prosa--service_manage)
* [`service_ensure`](#-prosa--service_ensure)
* [`manage_user`](#-prosa--manage_user)
* [`manage_group`](#-prosa--manage_group)
* [`user`](#-prosa--user)
* [`group`](#-prosa--group)
* [`telemetry_level`](#-prosa--telemetry_level)
* [`observability`](#-prosa--observability)

##### <a name="-prosa--prosa_name"></a>`prosa_name`

Data type: `String`

The name of your ProSA. It take this name to advertise himself.
This name is sometime very important for some processors.

Default value: `$prosa::params::prosa_name`

##### <a name="-prosa--service_name"></a>`service_name`

Data type: `String`

Sets the name of the ProSA service.

Default value: `$prosa::params::service_name`

##### <a name="-prosa--bin_repo"></a>`bin_repo`

Data type: `Optional[String]`

Link to the binary repository where the ProSA binary can be find.
See [Puppet File source attribute](https://www.puppet.com/docs/puppet/8/types/file.html#file-attribute-source) to set this parameter

Default value: `$prosa::params::bin_repo`

##### <a name="-prosa--bin_path"></a>`bin_path`

Data type: `Stdlib::Absolutepath`

Sets the path where the ProSA binary will be located.

Default value: `'/usr/local/bin/prosa'`

##### <a name="-prosa--log_dir"></a>`log_dir`

Data type: `Stdlib::Absolutepath`

Sets the directory where the ProSA logs files are located.

Default value: `'/var/log'`

##### <a name="-prosa--conf_dir"></a>`conf_dir`

Data type: `Stdlib::Absolutepath`

Sets the directory where the ProSA configuration files are located.

Default value: `$prosa::params::conf_dir`

##### <a name="-prosa--service_enable"></a>`service_enable`

Data type: `Boolean`

Determines whether Puppet enables the ProSA service when the system is booted.

Default value: `true`

##### <a name="-prosa--service_manage"></a>`service_manage`

Data type: `Boolean`

Determines whether Puppet manages the ProSA service's state.

Default value: `true`

##### <a name="-prosa--service_ensure"></a>`service_ensure`

Data type: `Variant[Stdlib::Ensure::Service, Boolean]`

Determines whether Puppet should make sure the service is running.
Valid values are: `true` (or `running`) or `false` (or `stopped`).<br />
The `false` or `stopped` values set the ProSA service resource's `ensure` parameter
to `false`, which is useful when you want to let the service be managed by another
application.<br />

Default value: `'running'`

##### <a name="-prosa--manage_user"></a>`manage_user`

Data type: `Boolean`

When `false`, stops Puppet from creating the user resource.<br />
This is for instances when you have a user, created from another Puppet module, you want
to use to run ProSA. Without this parameter, attempting to use a previously established
user would result in a duplicate resource error.

Default value: `true`

##### <a name="-prosa--manage_group"></a>`manage_group`

Data type: `Boolean`

When `false`, stops Puppet from creating the group resource.<br />
If you have a group created from another Puppet module that you want to use to run ProSA,
set this to `false`. Without this parameter, attempting to use a previously established
group results in a duplicate resource error.

Default value: `true`

##### <a name="-prosa--user"></a>`user`

Data type: `String`

Change the user that ProSA uses to run.
To prevent Puppet from managing the user, set the `manage_user` parameter to `false`.

Default value: `$prosa::params::user`

##### <a name="-prosa--group"></a>`group`

Data type: `String`

Changes the group ID that ProSA uses to run.
To prevent Puppet from managing the user, set the `manage_user` parameter to `false`.

Default value: `$prosa::params::group`

##### <a name="-prosa--telemetry_level"></a>`telemetry_level`

Data type: `ProSA::TelemetryLevel`

Configures the ProSA [TelemetryLevel](https://docs.rs/prosa-utils/latest/prosa_utils/config/tracing/enum.TelemetryLevel.html) directive
which adjusts the verbosity of telemetry messages recorded.

Default value: `$prosa::params::telemetry_level`

##### <a name="-prosa--observability"></a>`observability`

Data type: `Hash[String, Hash[String, Hash[String, String]]]`

Configures the ProSA [Observability](https://docs.rs/prosa-utils/latest/prosa_utils/config/observability/struct.Observability.html) directive
which configure metrics, traces and logs export.

Default value: `$prosa::params::observability`

### <a name="prosa--processors"></a>`prosa::processors`

Creates `prosa::proc` defined types.

#### Examples

##### To create a [ProSA processor](https://docs.rs/prosa/latest/prosa/core/proc/index.html) `stub-1`

```puppet
class { 'prosa::processors':
  processors => {
    'stub-1' => {
      'adaptor_config_path'          => undef,
      'proc_restart_duration_period' => undef,
      'proc_max_restart_period'      => undef,
      'proc_settings'                     => {
        'service_names' => ['test'],
      },
    },
  },
}
```

#### Parameters

The following parameters are available in the `prosa::processors` class:

* [`processors`](#-prosa--processors--processors)

##### <a name="-prosa--processors--processors"></a>`processors`

Data type: `Hash`

A hash, where the key represents the processor name and the value represents a hash of
`prosa::proc` defined type's parameters.

Default value: `{}`

## Defined types

### <a name="prosa--proc"></a>`prosa::proc`

Allows specialised configurations for ProSA processors

#### Examples

##### 

```puppet
class { 'prosa':
  default_vhost     => false,
  default_ssl_vhost => false,
}
```

#### Parameters

The following parameters are available in the `prosa::proc` defined type:

* [`adaptor_config_path`](#-prosa--proc--adaptor_config_path)
* [`adaptor_settings`](#-prosa--proc--adaptor_settings)
* [`proc_restart_duration_period`](#-prosa--proc--proc_restart_duration_period)
* [`proc_max_restart_period`](#-prosa--proc--proc_max_restart_period)
* [`proc_settings`](#-prosa--proc--proc_settings)
* [`config_file_mode`](#-prosa--proc--config_file_mode)

##### <a name="-prosa--proc--adaptor_config_path"></a>`adaptor_config_path`

Data type: `Optional[Stdlib::Absolutepath]`

For some ProSA adaptor, they need to have a configuration in addition to processor.
If needed you need to specify the path of it.

Default value: `undef`

##### <a name="-prosa--proc--adaptor_settings"></a>`adaptor_settings`

Data type: `Optional[Hash]`

All settings of the adaptor if needed.
The keys/values are depending of the adaptor.
The `adaptor_config_path` should be defined if it's sets.

Default value: `undef`

##### <a name="-prosa--proc--proc_restart_duration_period"></a>`proc_restart_duration_period`

Data type: `Optional[Integer[0, 86400000]]`

Period in milliseconds of processors restarts when an error is detected

Default value: `undef`

##### <a name="-prosa--proc--proc_max_restart_period"></a>`proc_max_restart_period`

Data type: `Optional[Integer[10, 604800]]`

Period in seconds of the maximum wait duration for a processor restart

Default value: `undef`

##### <a name="-prosa--proc--proc_settings"></a>`proc_settings`

Data type: `Hash`

All settings of the processor.
The keys/values are depending of the processor.

Default value: `{}`

##### <a name="-prosa--proc--config_file_mode"></a>`config_file_mode`

Data type: `Optional[String]`

Permissions mode for the processor configuration file
The file should be read at least by the ProSA process.
But can be reduced to avoid any configuration leak.
If not set, the permission will be '0644'.

Default value: `undef`

## Data types

### <a name="ProSA--TelemetryLevel"></a>`ProSA::TelemetryLevel`

A string that conforms to the ProSA `TelemetryLevel` syntax.
Different levels can be specified for individual _metrics_, _traces_, and _logs_.

The levels are (in order of decreasing significance):
* `error`
* `warn`
* `info`
* `debug`
* `trace`
* `off`

ProSA accept non case sensitive levels (like this type).

* **See also**
  * https://docs.rs/prosa-utils/latest/prosa_utils/config/tracing/enum.TelemetryLevel.html

Alias of `Pattern[/\A(?i:error|warn|info|debug|trace|off)\Z/]`

